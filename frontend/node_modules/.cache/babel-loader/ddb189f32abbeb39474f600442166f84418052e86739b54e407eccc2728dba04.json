{"ast":null,"code":"export const isHighlighted=(start,end,highlights)=>{return highlights.some(highlight=>start>=highlight.start&&end<=highlight.end||start<=highlight.start&&end>=highlight.end||start<=highlight.start&&end>highlight.start&&end<=highlight.end||start>=highlight.start&&start<highlight.end&&end>=highlight.end);};export const removeHighlight=(start,end,highlights)=>{return highlights.filter(highlight=>!(start>=highlight.start&&end<=highlight.end)&&!(start<=highlight.start&&end>=highlight.end)&&!(start<=highlight.start&&end>highlight.start&&end<=highlight.end)&&!(start>=highlight.start&&start<highlight.end&&end>=highlight.end));};export const getCharactersCountUntilNode=(node,parent)=>{const walker=document.createTreeWalker(parent||document.body,NodeFilter.SHOW_TEXT,null);let charCount=0;while(walker.nextNode()){var _walker$currentNode$t;if(walker.currentNode===node){break;}charCount+=((_walker$currentNode$t=walker.currentNode.textContent)===null||_walker$currentNode$t===void 0?void 0:_walker$currentNode$t.length)||0;}return charCount;};export const adjustSelectionBounds=(textContent,startIndex,endIndex)=>{let startAdjustment=0;let endAdjustment=0;const reStartIndex=/^[!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~]/g;while(!(textContent.charAt(startIndex+startAdjustment-1)===\" \"||textContent.charAt(startIndex+startAdjustment-1).match(reStartIndex))&&textContent.charAt(startIndex+startAdjustment-1)!==\"\"){startAdjustment-=1;}const reEndIndex=/[!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~]$/g;while(!(textContent.charAt(endIndex+endAdjustment)===\" \"||textContent.charAt(endIndex+endAdjustment).match(reEndIndex))&&textContent.charAt(endIndex+endAdjustment)!==\"\"){endAdjustment+=1;}return{start:startIndex+startAdjustment,end:endIndex+endAdjustment};};","map":{"version":3,"names":["isHighlighted","start","end","highlights","some","highlight","removeHighlight","filter","getCharactersCountUntilNode","node","parent","walker","document","createTreeWalker","body","NodeFilter","SHOW_TEXT","charCount","nextNode","_walker$currentNode$t","currentNode","textContent","length","adjustSelectionBounds","startIndex","endIndex","startAdjustment","endAdjustment","reStartIndex","charAt","match","reEndIndex"],"sources":["/Users/yiwang/Documents/ChatYoutube/streamlit-annotation-tools/src/streamlit_annotation_tools/frontend/src/helpers/highlightHelpers.ts"],"sourcesContent":["import { IReference } from \"../types/highlightTypes\"\n\nexport const isHighlighted = (\n  start: number,\n  end: number,\n  highlights: IReference[]\n): boolean => {\n  return highlights.some(\n    (highlight) =>\n      (start >= highlight.start && end <= highlight.end) ||\n      (start <= highlight.start && end >= highlight.end) ||\n      (start <= highlight.start &&\n        end > highlight.start &&\n        end <= highlight.end) ||\n      (start >= highlight.start &&\n        start < highlight.end &&\n        end >= highlight.end)\n  )\n}\n\nexport const removeHighlight = (\n  start: number,\n  end: number,\n  highlights: IReference[]\n): IReference[] => {\n  return highlights.filter(\n    (highlight) =>\n      !(start >= highlight.start && end <= highlight.end) &&\n      !(start <= highlight.start && end >= highlight.end) &&\n      !(\n        start <= highlight.start &&\n        end > highlight.start &&\n        end <= highlight.end\n      ) &&\n      !(\n        start >= highlight.start &&\n        start < highlight.end &&\n        end >= highlight.end\n      )\n  )\n}\n\nexport const getCharactersCountUntilNode = (\n  node: Node,\n  parent: HTMLElement | null\n): number => {\n  const walker = document.createTreeWalker(\n    parent || document.body,\n    NodeFilter.SHOW_TEXT,\n    null\n  )\n\n  let charCount = 0\n  while (walker.nextNode()) {\n    if (walker.currentNode === node) {\n      break\n    }\n    charCount += walker.currentNode.textContent?.length || 0\n  }\n\n  return charCount\n}\n\nexport const adjustSelectionBounds = (\n  textContent: string,\n  startIndex: number,\n  endIndex: number\n): { start: number; end: number } => {\n  let startAdjustment = 0\n  let endAdjustment = 0\n\n  const reStartIndex = /^[!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~]/g\n  while (\n    !(\n      textContent.charAt(startIndex + startAdjustment - 1) === \" \" ||\n      textContent.charAt(startIndex + startAdjustment - 1).match(reStartIndex)\n    ) &&\n    textContent.charAt(startIndex + startAdjustment - 1) !== \"\"\n  ) {\n    startAdjustment -= 1\n  }\n\n  const reEndIndex = /[!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~]$/g\n  while (\n    !(\n      textContent.charAt(endIndex + endAdjustment) === \" \" ||\n      textContent.charAt(endIndex + endAdjustment).match(reEndIndex)\n    ) &&\n    textContent.charAt(endIndex + endAdjustment) !== \"\"\n  ) {\n    endAdjustment += 1\n  }\n\n  return {\n    start: startIndex + startAdjustment,\n    end: endIndex + endAdjustment,\n  }\n}\n"],"mappings":"AAEA,MAAO,MAAM,CAAAA,aAAa,CAAGA,CAC3BC,KAAa,CACbC,GAAW,CACXC,UAAwB,GACZ,CACZ,MAAO,CAAAA,UAAU,CAACC,IAAI,CACnBC,SAAS,EACPJ,KAAK,EAAII,SAAS,CAACJ,KAAK,EAAIC,GAAG,EAAIG,SAAS,CAACH,GAAG,EAChDD,KAAK,EAAII,SAAS,CAACJ,KAAK,EAAIC,GAAG,EAAIG,SAAS,CAACH,GAAI,EACjDD,KAAK,EAAII,SAAS,CAACJ,KAAK,EACvBC,GAAG,CAAGG,SAAS,CAACJ,KAAK,EACrBC,GAAG,EAAIG,SAAS,CAACH,GAAI,EACtBD,KAAK,EAAII,SAAS,CAACJ,KAAK,EACvBA,KAAK,CAAGI,SAAS,CAACH,GAAG,EACrBA,GAAG,EAAIG,SAAS,CAACH,GACvB,CAAC,CACH,CAAC,CAED,MAAO,MAAM,CAAAI,eAAe,CAAGA,CAC7BL,KAAa,CACbC,GAAW,CACXC,UAAwB,GACP,CACjB,MAAO,CAAAA,UAAU,CAACI,MAAM,CACrBF,SAAS,EACR,EAAEJ,KAAK,EAAII,SAAS,CAACJ,KAAK,EAAIC,GAAG,EAAIG,SAAS,CAACH,GAAG,CAAC,EACnD,EAAED,KAAK,EAAII,SAAS,CAACJ,KAAK,EAAIC,GAAG,EAAIG,SAAS,CAACH,GAAG,CAAC,EACnD,EACED,KAAK,EAAII,SAAS,CAACJ,KAAK,EACxBC,GAAG,CAAGG,SAAS,CAACJ,KAAK,EACrBC,GAAG,EAAIG,SAAS,CAACH,GAAG,CACrB,EACD,EACED,KAAK,EAAII,SAAS,CAACJ,KAAK,EACxBA,KAAK,CAAGI,SAAS,CAACH,GAAG,EACrBA,GAAG,EAAIG,SAAS,CAACH,GAAG,CAE1B,CAAC,CACH,CAAC,CAED,MAAO,MAAM,CAAAM,2BAA2B,CAAGA,CACzCC,IAAU,CACVC,MAA0B,GACf,CACX,KAAM,CAAAC,MAAM,CAAGC,QAAQ,CAACC,gBAAgB,CACtCH,MAAM,EAAIE,QAAQ,CAACE,IAAI,CACvBC,UAAU,CAACC,SAAS,CACpB,IACF,CAAC,CAED,GAAI,CAAAC,SAAS,CAAG,CAAC,CACjB,MAAON,MAAM,CAACO,QAAQ,CAAC,CAAC,CAAE,KAAAC,qBAAA,CACxB,GAAIR,MAAM,CAACS,WAAW,GAAKX,IAAI,CAAE,CAC/B,MACF,CACAQ,SAAS,EAAI,EAAAE,qBAAA,CAAAR,MAAM,CAACS,WAAW,CAACC,WAAW,UAAAF,qBAAA,iBAA9BA,qBAAA,CAAgCG,MAAM,GAAI,CAAC,CAC1D,CAEA,MAAO,CAAAL,SAAS,CAClB,CAAC,CAED,MAAO,MAAM,CAAAM,qBAAqB,CAAGA,CACnCF,WAAmB,CACnBG,UAAkB,CAClBC,QAAgB,GACmB,CACnC,GAAI,CAAAC,eAAe,CAAG,CAAC,CACvB,GAAI,CAAAC,aAAa,CAAG,CAAC,CAErB,KAAM,CAAAC,YAAY,CAAG,sCAAsC,CAC3D,MACE,EACEP,WAAW,CAACQ,MAAM,CAACL,UAAU,CAAGE,eAAe,CAAG,CAAC,CAAC,GAAK,GAAG,EAC5DL,WAAW,CAACQ,MAAM,CAACL,UAAU,CAAGE,eAAe,CAAG,CAAC,CAAC,CAACI,KAAK,CAACF,YAAY,CAAC,CACzE,EACDP,WAAW,CAACQ,MAAM,CAACL,UAAU,CAAGE,eAAe,CAAG,CAAC,CAAC,GAAK,EAAE,CAC3D,CACAA,eAAe,EAAI,CAAC,CACtB,CAEA,KAAM,CAAAK,UAAU,CAAG,sCAAsC,CACzD,MACE,EACEV,WAAW,CAACQ,MAAM,CAACJ,QAAQ,CAAGE,aAAa,CAAC,GAAK,GAAG,EACpDN,WAAW,CAACQ,MAAM,CAACJ,QAAQ,CAAGE,aAAa,CAAC,CAACG,KAAK,CAACC,UAAU,CAAC,CAC/D,EACDV,WAAW,CAACQ,MAAM,CAACJ,QAAQ,CAAGE,aAAa,CAAC,GAAK,EAAE,CACnD,CACAA,aAAa,EAAI,CAAC,CACpB,CAEA,MAAO,CACL1B,KAAK,CAAEuB,UAAU,CAAGE,eAAe,CACnCxB,GAAG,CAAEuB,QAAQ,CAAGE,aAClB,CAAC,CACH,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}